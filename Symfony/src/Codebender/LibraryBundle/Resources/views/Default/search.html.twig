<head>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-responsive.min.css" rel="stylesheet">

    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>

    <script>

        function update_results(){
            if($("#query").val().length>0)
            {
                window.history.replaceState(null, "Search",  "?q=" + $("#query").val());
                $.getJSON( "{{ path('codebender_library_search') }}" + "?json=true&q="+ $("#query").val())
                        .done(function( data ) {
                            if(data.success)
                            {
                                $( "#resultsDiv" ).empty();
                                var resultsHTML = "";
                                $.each(data.libs, function(k,v){
                                    console.log(v );
                                    resultsHTML += '<p><a href = "{{ path('codebender_library_view_library', {'auth_key': 'authKey', 'version': 'v1'}) }}?library='+v+'">'+v+'</a></p>'
                                });
                                $( "#resultsDiv" ).html(resultsHTML);
                            }
                        });
            }
            else
            {
                window.history.replaceState(null, "Search", "search ");
                $( "#resultsDiv" ).empty();
            }
        }


        $(document).ready(function()
        {
            $( "#query" ).keyup(function() { update_results() });
        });

    </script>

</head>
<body>
<div><input type="text" id="query" autocomplete="off" placeholder="Search libaries.."/></div>

<div id="resultsDiv">
    {%  for lib in libs %}
        <p><a href = "{{ path('codebender_library_view_library', {'auth_key': 'authKey', 'version': 'v1'}) }}?library={{ lib }}">{{ lib }}</a></p>
    {% endfor %}
</div>

</body>